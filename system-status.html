<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‘å·¥åŠ - ç³»ç»ŸçŠ¶æ€æ£€æŸ¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="max-w-6xl mx-auto p-8">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">ğŸ” ç³»ç»ŸçŠ¶æ€æ£€æŸ¥</h1>
            <p class="text-gray-600">å…¨é¢æ£€æŸ¥ç½‘ç«™åŠŸèƒ½å’Œé…ç½®çŠ¶æ€</p>
        </div>

        <!-- æ£€æŸ¥è¿›åº¦ -->
        <div id="check-progress" class="bg-white rounded-lg shadow-sm border p-6 mb-8">
            <div class="flex items-center justify-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"></div>
                <span class="text-gray-600">æ­£åœ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...</span>
            </div>
        </div>

        <!-- æ£€æŸ¥ç»“æœ -->
        <div id="check-results" class="hidden">
            <!-- åŸºç¡€åŠŸèƒ½æ£€æŸ¥ -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸ”§ åŸºç¡€åŠŸèƒ½æ£€æŸ¥</h3>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">æµè§ˆå™¨å…¼å®¹æ€§</span>
                            <span id="browser-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">JavaScriptæ”¯æŒ</span>
                            <span id="js-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">æœ¬åœ°å­˜å‚¨</span>
                            <span id="storage-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">ç½‘ç»œè¿æ¥</span>
                            <span id="network-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸ‘¥ ç”¨æˆ·ç³»ç»Ÿæ£€æŸ¥</h3>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">ç”¨æˆ·æ•°æ®</span>
                            <span id="user-data-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">ç™»å½•çŠ¶æ€</span>
                            <span id="login-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">æƒé™éªŒè¯</span>
                            <span id="permission-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <span class="text-sm text-gray-700">ä¼šè¯ç®¡ç†</span>
                            <span id="session-status" class="text-sm px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GitHubåŒæ­¥æ£€æŸ¥ -->
            <div class="bg-white rounded-lg shadow-sm border p-6 mb-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸ”„ GitHubåŒæ­¥æ£€æŸ¥</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">é…ç½®çŠ¶æ€</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">Tokené…ç½®</span>
                                <span id="token-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">Gist ID</span>
                                <span id="gist-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">è¿æ¥çŠ¶æ€</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">APIè¿æ¥</span>
                                <span id="api-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">æƒé™éªŒè¯</span>
                                <span id="api-permission-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">åŒæ­¥çŠ¶æ€</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">è‡ªåŠ¨åŒæ­¥</span>
                                <span id="auto-sync-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">æœ€ååŒæ­¥</span>
                                <span id="last-sync-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é¡µé¢åŠŸèƒ½æ£€æŸ¥ -->
            <div class="bg-white rounded-lg shadow-sm border p-6 mb-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸ“„ é¡µé¢åŠŸèƒ½æ£€æŸ¥</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">ç™»å½•é¡µé¢</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">é¡µé¢åŠ è½½</span>
                                <span id="login-page-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">è¡¨å•éªŒè¯</span>
                                <span id="login-form-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">ç®¡ç†å‘˜é¡µé¢</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">æƒé™æ£€æŸ¥</span>
                                <span id="admin-permission-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">åŠŸèƒ½å¯ç”¨</span>
                                <span id="admin-function-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">å­¦ç”Ÿé¡µé¢</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">æƒé™æ£€æŸ¥</span>
                                <span id="student-permission-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">åŠŸèƒ½å¯ç”¨</span>
                                <span id="student-function-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">æ•™å¸ˆé¡µé¢</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">æƒé™æ£€æŸ¥</span>
                                <span id="teacher-permission-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">åŠŸèƒ½å¯ç”¨</span>
                                <span id="teacher-function-status" class="text-xs px-2 py-1 rounded-full">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é—®é¢˜è¯Šæ–­ -->
            <div class="bg-white rounded-lg shadow-sm border p-6 mb-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸ” é—®é¢˜è¯Šæ–­</h3>
                <div id="diagnosis-results" class="space-y-3">
                    <!-- è¯Šæ–­ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </div>

            <!-- å¿«é€Ÿä¿®å¤ -->
            <div class="bg-white rounded-lg shadow-sm border p-6 mb-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">âš¡ å¿«é€Ÿä¿®å¤</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="quickFixLogin()" class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="text-center">
                            <i data-lucide="log-in" class="h-6 w-6 text-blue-600 mx-auto mb-2"></i>
                            <div class="font-medium text-gray-900">ä¿®å¤ç™»å½•é—®é¢˜</div>
                            <div class="text-xs text-gray-600">é‡ç½®ç”¨æˆ·æ•°æ®</div>
                        </div>
                    </button>
                    
                    <button onclick="clearAllData()" class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="text-center">
                            <i data-lucide="trash-2" class="h-6 w-6 text-red-600 mx-auto mb-2"></i>
                            <div class="font-medium text-gray-900">æ¸…é™¤æ‰€æœ‰æ•°æ®</div>
                            <div class="text-xs text-gray-600">é‡ç½®åˆ°åˆå§‹çŠ¶æ€</div>
                        </div>
                    </button>
                    
                    <button onclick="testAllPages()" class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="text-center">
                            <i data-lucide="test-tube" class="h-6 w-6 text-green-600 mx-auto mb-2"></i>
                            <div class="font-medium text-gray-900">æµ‹è¯•æ‰€æœ‰é¡µé¢</div>
                            <div class="text-xs text-gray-600">éªŒè¯åŠŸèƒ½å®Œæ•´æ€§</div>
                        </div>
                    </button>
                </div>
            </div>

            <!-- å¿«é€Ÿè®¿é—® -->
            <div class="bg-white rounded-lg shadow-sm border p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸš€ å¿«é€Ÿè®¿é—®</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button onclick="window.location.href='index.html'" class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="text-center">
                            <i data-lucide="log-in" class="h-6 w-6 text-blue-600 mx-auto mb-2"></i>
                            <span class="text-sm font-medium text-gray-700">ç™»å½•é¡µé¢</span>
                        </div>
                    </button>
                    
                    <button onclick="window.location.href='admin-dashboard.html'" class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="text-center">
                            <i data-lucide="layout-dashboard" class="h-6 w-6 text-purple-600 mx-auto mb-2"></i>
                            <span class="text-sm font-medium text-gray-700">ç®¡ç†å‘˜æ§åˆ¶å°</span>
                        </div>
                    </button>
                    
                    <button onclick="window.location.href='test-admin-features.html'" class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="text-center">
                            <i data-lucide="test-tube" class="h-6 w-6 text-green-600 mx-auto mb-2"></i>
                            <span class="text-sm font-medium text-gray-700">åŠŸèƒ½æµ‹è¯•</span>
                        </div>
                    </button>
                    
                    <button onclick="window.location.href='navigation.html'" class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="text-center">
                            <i data-lucide="navigation" class="h-6 w-6 text-orange-600 mx-auto mb-2"></i>
                            <span class="text-sm font-medium text-gray-700">å¯¼èˆªä¸­å¿ƒ</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–Lucideå›¾æ ‡
        lucide.createIcons();

        // æ£€æŸ¥åŸºç¡€åŠŸèƒ½
        function checkBasicFunctions() {
            // æµè§ˆå™¨å…¼å®¹æ€§
            const browserStatus = document.getElementById('browser-status');
            if (typeof window !== 'undefined' && window.localStorage) {
                browserStatus.textContent = 'æ­£å¸¸';
                browserStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';
            } else {
                browserStatus.textContent = 'å¼‚å¸¸';
                browserStatus.className = 'text-sm px-2 py-1 rounded-full bg-red-100 text-red-800';
            }

            // JavaScriptæ”¯æŒ
            const jsStatus = document.getElementById('js-status');
            jsStatus.textContent = 'æ­£å¸¸';
            jsStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';

            // æœ¬åœ°å­˜å‚¨
            const storageStatus = document.getElementById('storage-status');
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                storageStatus.textContent = 'æ­£å¸¸';
                storageStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';
            } catch (error) {
                storageStatus.textContent = 'å¼‚å¸¸';
                storageStatus.className = 'text-sm px-2 py-1 rounded-full bg-red-100 text-red-800';
            }

            // ç½‘ç»œè¿æ¥
            const networkStatus = document.getElementById('network-status');
            if (navigator.onLine) {
                networkStatus.textContent = 'åœ¨çº¿';
                networkStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';
            } else {
                networkStatus.textContent = 'ç¦»çº¿';
                networkStatus.className = 'text-sm px-2 py-1 rounded-full bg-yellow-100 text-yellow-800';
            }
        }

        // æ£€æŸ¥ç”¨æˆ·ç³»ç»Ÿ
        function checkUserSystem() {
            // ç”¨æˆ·æ•°æ®
            const userDataStatus = document.getElementById('user-data-status');
            const savedUsers = localStorage.getItem('admin_users');
            if (savedUsers) {
                try {
                    const users = JSON.parse(savedUsers);
                    userDataStatus.textContent = `${users.length}ä¸ªç”¨æˆ·`;
                    userDataStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';
                } catch (error) {
                    userDataStatus.textContent = 'æ•°æ®æŸå';
                    userDataStatus.className = 'text-sm px-2 py-1 rounded-full bg-red-100 text-red-800';
                }
            } else {
                userDataStatus.textContent = 'æ— æ•°æ®';
                userDataStatus.className = 'text-sm px-2 py-1 rounded-full bg-yellow-100 text-yellow-800';
            }

            // ç™»å½•çŠ¶æ€
            const loginStatus = document.getElementById('login-status');
            const currentUser = sessionStorage.getItem('currentUser');
            if (currentUser) {
                try {
                    const user = JSON.parse(currentUser);
                    loginStatus.textContent = `${user.role}å·²ç™»å½•`;
                    loginStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';
                } catch (error) {
                    loginStatus.textContent = 'ä¼šè¯å¼‚å¸¸';
                    loginStatus.className = 'text-sm px-2 py-1 rounded-full bg-red-100 text-red-800';
                }
            } else {
                loginStatus.textContent = 'æœªç™»å½•';
                loginStatus.className = 'text-sm px-2 py-1 rounded-full bg-gray-100 text-gray-800';
            }

            // æƒé™éªŒè¯
            const permissionStatus = document.getElementById('permission-status');
            if (currentUser) {
                try {
                    const user = JSON.parse(currentUser);
                    if (user.role && ['admin', 'student', 'teacher'].includes(user.role)) {
                        permissionStatus.textContent = 'æ­£å¸¸';
                        permissionStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';
                    } else {
                        permissionStatus.textContent = 'æƒé™å¼‚å¸¸';
                        permissionStatus.className = 'text-sm px-2 py-1 rounded-full bg-red-100 text-red-800';
                    }
                } catch (error) {
                    permissionStatus.textContent = 'éªŒè¯å¤±è´¥';
                    permissionStatus.className = 'text-sm px-2 py-1 rounded-full bg-red-100 text-red-800';
                }
            } else {
                permissionStatus.textContent = 'æœªéªŒè¯';
                permissionStatus.className = 'text-sm px-2 py-1 rounded-full bg-gray-100 text-gray-800';
            }

            // ä¼šè¯ç®¡ç†
            const sessionStatus = document.getElementById('session-status');
            if (typeof sessionStorage !== 'undefined') {
                sessionStatus.textContent = 'æ­£å¸¸';
                sessionStatus.className = 'text-sm px-2 py-1 rounded-full bg-green-100 text-green-800';
            } else {
                sessionStatus.textContent = 'å¼‚å¸¸';
                sessionStatus.className = 'text-sm px-2 py-1 rounded-full bg-red-100 text-red-800';
            }
        }

        // æ£€æŸ¥GitHubåŒæ­¥
        function checkGitHubSync() {
            // Tokené…ç½®
            const tokenStatus = document.getElementById('token-status');
            const token = localStorage.getItem('github_token');
            if (token) {
                tokenStatus.textContent = 'å·²é…ç½®';
                tokenStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            } else {
                tokenStatus.textContent = 'æœªé…ç½®';
                tokenStatus.className = 'text-xs px-2 py-1 rounded-full bg-yellow-100 text-yellow-800';
            }

            // Gist ID
            const gistStatus = document.getElementById('gist-status');
            const gistId = localStorage.getItem('github_gist_id');
            if (gistId) {
                gistStatus.textContent = 'å·²é…ç½®';
                gistStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            } else {
                gistStatus.textContent = 'æœªé…ç½®';
                gistStatus.className = 'text-xs px-2 py-1 rounded-full bg-yellow-100 text-yellow-800';
            }

            // APIè¿æ¥
            const apiStatus = document.getElementById('api-status');
            apiStatus.textContent = 'å¾…æµ‹è¯•';
            apiStatus.className = 'text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800';

            // APIæƒé™
            const apiPermissionStatus = document.getElementById('api-permission-status');
            apiPermissionStatus.textContent = 'å¾…æµ‹è¯•';
            apiPermissionStatus.className = 'text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800';

            // è‡ªåŠ¨åŒæ­¥
            const autoSyncStatus = document.getElementById('auto-sync-status');
            const autoSyncInterval = localStorage.getItem('github_auto_sync_interval');
            if (autoSyncInterval) {
                autoSyncStatus.textContent = 'å·²å¯ç”¨';
                autoSyncStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            } else {
                autoSyncStatus.textContent = 'æœªå¯ç”¨';
                autoSyncStatus.className = 'text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800';
            }

            // æœ€ååŒæ­¥
            const lastSyncStatus = document.getElementById('last-sync-status');
            const lastSync = localStorage.getItem('github_last_sync');
            if (lastSync) {
                const syncTime = new Date(lastSync).toLocaleString();
                lastSyncStatus.textContent = syncTime;
                lastSyncStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            } else {
                lastSyncStatus.textContent = 'ä»æœªåŒæ­¥';
                lastSyncStatus.className = 'text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800';
            }
        }

        // æ£€æŸ¥é¡µé¢åŠŸèƒ½
        function checkPageFunctions() {
            // ç™»å½•é¡µé¢
            const loginPageStatus = document.getElementById('login-page-status');
            const loginFormStatus = document.getElementById('login-form-status');
            loginPageStatus.textContent = 'æ­£å¸¸';
            loginPageStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            loginFormStatus.textContent = 'æ­£å¸¸';
            loginFormStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';

            // ç®¡ç†å‘˜é¡µé¢
            const adminPermissionStatus = document.getElementById('admin-permission-status');
            const adminFunctionStatus = document.getElementById('admin-function-status');
            adminPermissionStatus.textContent = 'å·²å®ç°';
            adminFunctionStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            adminFunctionStatus.textContent = 'æ­£å¸¸';
            adminFunctionStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';

            // å­¦ç”Ÿé¡µé¢
            const studentPermissionStatus = document.getElementById('student-permission-status');
            const studentFunctionStatus = document.getElementById('student-function-status');
            studentPermissionStatus.textContent = 'å·²å®ç°';
            studentPermissionStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            studentFunctionStatus.textContent = 'æ­£å¸¸';
            studentFunctionStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';

            // æ•™å¸ˆé¡µé¢
            const teacherPermissionStatus = document.getElementById('teacher-permission-status');
            const teacherFunctionStatus = document.getElementById('teacher-function-status');
            teacherPermissionStatus.textContent = 'å·²å®ç°';
            teacherPermissionStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
            teacherFunctionStatus.textContent = 'æ­£å¸¸';
            teacherFunctionStatus.className = 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800';
        }

        // ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
        function generateDiagnosis() {
            const diagnosisResults = document.getElementById('diagnosis-results');
            const issues = [];

            // æ£€æŸ¥ç”¨æˆ·æ•°æ®
            const savedUsers = localStorage.getItem('admin_users');
            if (!savedUsers) {
                issues.push({
                    type: 'warning',
                    message: 'æœªæ£€æµ‹åˆ°ç”¨æˆ·æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨å¿«é€Ÿä¿®å¤åŠŸèƒ½åˆå§‹åŒ–ç³»ç»Ÿ'
                });
            }

            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            const currentUser = sessionStorage.getItem('currentUser');
            if (!currentUser) {
                issues.push({
                    type: 'info',
                    message: 'å½“å‰æœªç™»å½•ï¼Œè¯·å…ˆç™»å½•ç³»ç»Ÿ'
                });
            }

            // æ£€æŸ¥GitHubåŒæ­¥é…ç½®
            const token = localStorage.getItem('github_token');
            const gistId = localStorage.getItem('github_gist_id');
            if (!token || !gistId) {
                issues.push({
                    type: 'info',
                    message: 'GitHubåŒæ­¥åŠŸèƒ½æœªé…ç½®ï¼Œç®¡ç†å‘˜å¯åœ¨æ§åˆ¶å°ä¸­é…ç½®'
                });
            }

            // æ˜¾ç¤ºè¯Šæ–­ç»“æœ
            if (issues.length === 0) {
                diagnosisResults.innerHTML = `
                    <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-center">
                            <i data-lucide="check-circle" class="h-5 w-5 text-green-600 mr-2"></i>
                            <span class="text-green-800">ç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼Œæœªå‘ç°æ˜æ˜¾é—®é¢˜</span>
                        </div>
                    </div>
                `;
            } else {
                diagnosisResults.innerHTML = issues.map(issue => `
                    <div class="p-4 ${issue.type === 'warning' ? 'bg-yellow-50 border-yellow-200' : 'bg-blue-50 border-blue-200'} border rounded-lg">
                        <div class="flex items-center">
                            <i data-lucide="${issue.type === 'warning' ? 'alert-triangle' : 'info'}" class="h-5 w-5 ${issue.type === 'warning' ? 'text-yellow-600' : 'text-blue-600'} mr-2"></i>
                            <span class="${issue.type === 'warning' ? 'text-yellow-800' : 'text-blue-800'}">${issue.message}</span>
                        </div>
                    </div>
                `).join('');
            }

            lucide.createIcons();
        }

        // å¿«é€Ÿä¿®å¤ç™»å½•é—®é¢˜
        function quickFixLogin() {
            if (confirm('ç¡®å®šè¦ä¿®å¤ç™»å½•é—®é¢˜å—ï¼Ÿè¿™å°†é‡ç½®ç”¨æˆ·æ•°æ®åˆ°é»˜è®¤çŠ¶æ€ã€‚')) {
                localStorage.removeItem('admin_users');
                sessionStorage.removeItem('currentUser');
                
                // é‡æ–°åˆå§‹åŒ–é»˜è®¤ç”¨æˆ·
                const defaultUsers = [
                    {
                        id: 1,
                        username: 'student1',
                        password: '123456',
                        realName: 'å¼ ä¸‰',
                        email: 'student1@demo.com',
                        phone: '13800138001',
                        role: 'student',
                        status: 'active',
                        grade: 'grade3',
                        registerTime: '2024-01-01',
                        lastLogin: 'ä»æœªç™»å½•'
                    },
                    {
                        id: 2,
                        username: 'student2',
                        password: '123456',
                        realName: 'æå››',
                        email: 'student2@demo.com',
                        phone: '13800138002',
                        role: 'student',
                        status: 'active',
                        grade: 'grade4',
                        registerTime: '2024-01-02',
                        lastLogin: 'ä»æœªç™»å½•'
                    },
                    {
                        id: 3,
                        username: 'teacher1',
                        password: '123456',
                        realName: 'ç‹è€å¸ˆ',
                        email: 'teacher1@demo.com',
                        phone: '13800138003',
                        role: 'teacher',
                        status: 'active',
                        registerTime: '2024-01-03',
                        lastLogin: 'ä»æœªç™»å½•'
                    },
                    {
                        id: 4,
                        username: 'teacher2',
                        password: '123456',
                        realName: 'æè€å¸ˆ',
                        email: 'teacher2@demo.com',
                        phone: '13800138004',
                        role: 'teacher',
                        status: 'active',
                        registerTime: '2024-01-04',
                        lastLogin: 'ä»æœªç™»å½•'
                    }
                ];
                
                localStorage.setItem('admin_users', JSON.stringify(defaultUsers));
                alert('âœ… ç™»å½•é—®é¢˜ä¿®å¤å®Œæˆï¼\n\nå·²åˆå§‹åŒ–é»˜è®¤ç”¨æˆ·æ•°æ®ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è´¦å·ç™»å½•ï¼š\n\nğŸ‘¨â€ğŸ’¼ ç®¡ç†å‘˜ï¼š18072830839 / ysh938798\nğŸ‘¨â€ğŸ“ å­¦ç”Ÿï¼šstudent1 / 123456 (å¼ ä¸‰)\nğŸ‘¨â€ğŸ« æ•™å¸ˆï¼šteacher1 / 123456 (ç‹è€å¸ˆ)');
                
                // é‡æ–°æ£€æŸ¥
                setTimeout(() => {
                    checkUserSystem();
                    generateDiagnosis();
                }, 1000);
            }
        }

        // æ¸…é™¤æ‰€æœ‰æ•°æ®
        function clearAllData() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                localStorage.clear();
                sessionStorage.clear();
                alert('âœ… æ‰€æœ‰æ•°æ®å·²æ¸…é™¤ï¼\n\nç³»ç»Ÿå·²é‡ç½®åˆ°åˆå§‹çŠ¶æ€ï¼Œè¯·åˆ·æ–°é¡µé¢ã€‚');
                
                // é‡æ–°æ£€æŸ¥
                setTimeout(() => {
                    checkUserSystem();
                    checkGitHubSync();
                    generateDiagnosis();
                }, 1000);
            }
        }

        // æµ‹è¯•æ‰€æœ‰é¡µé¢
        function testAllPages() {
            const pages = [
                'index.html',
                'admin-dashboard.html',
                'student-dashboard.html',
                'teacher-dashboard.html',
                'navigation.html'
            ];
            
            pages.forEach((page, index) => {
                setTimeout(() => {
                    window.open(page, '_blank');
                }, index * 500);
            });
            
            alert('æ­£åœ¨æ‰“å¼€æ‰€æœ‰ä¸»è¦é¡µé¢è¿›è¡Œæµ‹è¯•...');
        }

        // æ‰§è¡Œæ‰€æœ‰æ£€æŸ¥
        function runAllChecks() {
            checkBasicFunctions();
            checkUserSystem();
            checkGitHubSync();
            checkPageFunctions();
            generateDiagnosis();
            
            // æ˜¾ç¤ºç»“æœ
            document.getElementById('check-progress').classList.add('hidden');
            document.getElementById('check-results').classList.remove('hidden');
        }

        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œæ£€æŸ¥
        window.addEventListener('load', function() {
            setTimeout(runAllChecks, 1000);
        });
    </script>
</body>
</html> 